<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>DXB Gate Picker</title>

  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100vh;
      background: #1f9d55;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #ffffff;
    }

    .container {
      width: 100%;
      max-width: 420px;
      padding: 32px 24px 40px;
      text-align: center;
    }

    h1 {
      font-size: 28px;
      margin: 0 0 40px;
      font-weight: 800;
      letter-spacing: 0.5px;
    }

    .result {
      font-size: 92px;
      font-weight: 400;
      line-height: 1;
      letter-spacing: 1px;
      display: inline-block;
      text-shadow: 0 10px 28px rgba(0,0,0,0.25);
    }

    @keyframes pop {
      0%   { transform: translateY(18px) scale(0.8); opacity: 0; }
      55%  { transform: translateY(-10px) scale(1.25); opacity: 1; }
      80%  { transform: translateY(4px) scale(0.96); }
      100% { transform: translateY(0) scale(1); }
    }
    .pop { animation: pop 460ms cubic-bezier(.2,.9,.2,1) both; }

    /* ---------- Buttons ---------- */
    .btn {
      width: 100%;
      border: none;
      border-radius: 18px;
      background: #ffffff;
      cursor: pointer;
      box-shadow: 0 7px 0 #148243;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.06s ease, box-shadow 0.06s ease, background-color 0.12s ease;
      -webkit-tap-highlight-color: transparent;
      position: relative;
      overflow: hidden;
    }

    /* 회색으로 눌리는 효과 (CSS) */
    .btn:active {
      transform: translateY(5px);
      box-shadow: 0 2px 0 #148243;
      background-color: #e5e7eb; /* 연한 회색 */
    }

    /* 회색 오버레이를 더 확실히 보이게 (JS로 토글) */
    .btn.pressed::after {
      content: "";
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.08);
    }

    #pickBtn { margin-top: 52px; height: 88px; }
    #pickBtn svg { width: 46px; height: 46px; stroke: #1f9d55; stroke-width: 2.2; fill: none; }

    #mapBtn {
      margin-top: 14px;
      height: 62px;
      font-size: 16px;
      font-weight: 700;
      color: #1f9d55;
      letter-spacing: 0.2px;
    }
    #mapBtn svg {
      width: 18px;
      height: 18px;
      margin-right: 10px;
      stroke: #1f9d55;
      stroke-width: 2.2;
      fill: none;
    }

    /* ---------- Fullscreen viewer ---------- */
    .viewer {
      position: fixed;
      inset: 0;
      background: #000;
      display: none;
      z-index: 999;
      touch-action: pan-y;
    }
    .viewer.show { display: block; }

    .viewerHeader {
      position: absolute;
      top: 0; left: 0; right: 0;
      padding: 14px 14px 10px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      z-index: 3;
      background: linear-gradient(to bottom, rgba(0,0,0,0.55), rgba(0,0,0,0));
    }

    .badge {
      font-size: 13px;
      font-weight: 700;
      color: rgba(255,255,255,0.9);
      background: rgba(255,255,255,0.14);
      border: 1px solid rgba(255,255,255,0.18);
      padding: 8px 10px;
      border-radius: 999px;
      backdrop-filter: blur(8px);
    }

    .closeX {
      border: none;
      background: rgba(255,255,255,0.14);
      border: 1px solid rgba(255,255,255,0.18);
      border-radius: 14px;
      width: 44px; height: 44px;
      display: grid; place-items: center;
      cursor: pointer;
      backdrop-filter: blur(8px);
      -webkit-tap-highlight-color: transparent;
    }
    .closeX svg { width: 22px; height: 22px; stroke: #fff; stroke-width: 2.4; fill: none; }

    .track {
      height: 100%;
      width: 100%;
      display: flex;
      transform: translateX(0);
      transition: transform 240ms ease;
      will-change: transform;
      touch-action: pan-y;
    }

    .slide {
      min-width: 100%;
      height: 100%;
      display: grid;
      place-items: center;
      padding: 64px 10px 18px;
      user-select: none;
    }

    .slide img {
      max-width: 100%;
      max-height: calc(100vh - 90px);
      object-fit: contain;
      display: block;
    }

    .dots {
      position: absolute;
      left: 0; right: 0; bottom: 14px;
      display: flex; justify-content: center; gap: 8px;
      z-index: 3; pointer-events: none;
    }
    .dot { width: 7px; height: 7px; border-radius: 999px; background: rgba(255,255,255,0.35); }
    .dot.active { background: rgba(255,255,255,0.92); }
  </style>
</head>

<body>
  <div class="container">
    <h1>DXB Gate Picker</h1>

    <div class="result" id="result">—</div>

    <button id="pickBtn" class="btn" type="button" aria-label="Generate Gate">
      <svg viewBox="0 0 24 24" aria-hidden="true">
        <path d="M21 12a9 9 0 1 1-2.64-6.36"/>
        <polyline points="21 3 21 9 15 9"/>
      </svg>
    </button>

    <button id="mapBtn" class="btn" type="button" aria-label="View Map">
      <svg viewBox="0 0 24 24" aria-hidden="true">
        <path d="M3 6l6-2 6 2 6-2v14l-6 2-6-2-6 2V6z"/>
        <path d="M9 4v14M15 6v14"/>
      </svg>
      View Map
    </button>
  </div>

  <!-- Fullscreen swipe viewer -->
  <div id="viewer" class="viewer" role="dialog" aria-modal="true" aria-label="Maps">
    <div class="viewerHeader">
      <div id="badge" class="badge">1 / 2</div>
      <button id="closeViewer" class="closeX" type="button" aria-label="Close">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M6 6l12 12M18 6L6 18"/>
        </svg>
      </button>
    </div>

    <div id="track" class="track">
      <!-- 루트에 h1.png, h2.png 업로드 -->
      <div class="slide"><img src="h1.png" alt="h1 map" draggable="false" /></div>
      <div class="slide"><img src="h2.png" alt="h2 map" draggable="false" /></div>
    </div>

    <div class="dots" aria-hidden="true">
      <div class="dot" id="dot0"></div>
      <div class="dot" id="dot1"></div>
    </div>
  </div>

  <script>
    /* ---------- Button pressed helper ---------- */
    const addPressFeedback = (btn) => {
      const on = () => btn.classList.add('pressed');
      const off = () => btn.classList.remove('pressed');
      btn.addEventListener('pointerdown', on);
      btn.addEventListener('pointerup', off);
      btn.addEventListener('pointerleave', off);
      btn.addEventListener('pointercancel', off);
    };

    /* ---------- Gate logic ---------- */
    const range = (p, s, e, ex = new Set()) => {
      const a = []; for (let i=s;i<=e;i++){ const v=`${p}${i}`; if(!ex.has(v)) a.push(v); }
      return a;
    };
    const poolA = range("A",1,24,new Set(["A6","A7","A18","A19"]));
    const poolB = range("B",6,32,new Set(["B7","B16"]));
    const poolC = [...range("C",1,23,new Set(["C15"])), ...range("C",37,46)];
    const pools = { A: poolA, B: poolB, C: poolC, Remote: ["Remote"] };

    const pickCategory = () => {
      const r = Math.random()*100;
      if (r<30) return "A"; if (r<60) return "B"; if (r<90) return "C"; return "Remote";
    };
    const pickOne = (a) => a[Math.floor(Math.random()*a.length)];

    const haptic = () => { if (navigator.vibrate) navigator.vibrate([20,12,20]); };

    const resultEl = document.getElementById('result');
    const pickBtn = document.getElementById('pickBtn');
    const mapBtn  = document.getElementById('mapBtn');

    addPressFeedback(pickBtn);
    addPressFeedback(mapBtn);

    const playPop = () => {
      resultEl.classList.remove('pop'); void resultEl.offsetWidth; resultEl.classList.add('pop');
    };

    pickBtn.addEventListener('click', () => {
      haptic();
      resultEl.textContent = pickOne(pools[pickCategory()]);
      playPop();
    });

    /* ---------- Viewer ---------- */
    const viewer = document.getElementById('viewer');
    const closeViewer = document.getElementById('closeViewer');
    const track = document.getElementById('track');
    const badge = document.getElementById('badge');
    const dots = [document.getElementById('dot0'), document.getElementById('dot1')];
    let index = 0;

    const setIndex = (i, animate=true) => {
      index = Math.max(0, Math.min(1, i));
      track.style.transition = animate ? 'transform 240ms ease' : 'none';
      track.style.transform = `translateX(${-index*100}%)`;
      badge.textContent = `${index+1} / 2`;
      dots.forEach((d,idx)=>d.classList.toggle('active', idx===index));
    };

    mapBtn.addEventListener('click', () => {
      viewer.classList.add('show');
      document.body.style.overflow='hidden';
      setIndex(0,false);
    });
    closeViewer.addEventListener('click', () => {
      viewer.classList.remove('show');
      document.body.style.overflow='';
    });

    // Swipe (간단)
    let sx=0, dx=0, dragging=false;
    track.addEventListener('touchstart', e=>{ sx=e.touches[0].clientX; dragging=true; track.style.transition='none'; }, {passive:true});
    track.addEventListener('touchmove', e=>{ if(!dragging) return; dx=e.touches[0].clientX - sx; track.style.transform=`translateX(${(-index*window.innerWidth)+dx}px)`; }, {passive:true});
    track.addEventListener('touchend', ()=>{ dragging=false; const th=window.innerWidth*0.22; if(dx>th) setIndex(index-1); else if(dx<-th) setIndex(index+1); else setIndex(index); dx=0; }, {passive:true});
  </script>
</body>
</html>
